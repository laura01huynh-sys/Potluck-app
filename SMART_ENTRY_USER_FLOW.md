# Smart Ingredient Entry System - User Flow Guide

## Screen 1: Entry Gate (AddIngredientScreen)

### Visual Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚   Add Items to Your Pantry              â”‚
â”‚   Choose how you would like to add itemsâ”‚
â”‚                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                                   â”‚ â”‚
â”‚   â”‚         ğŸ“·  Scan Fridge           â”‚ â”‚
â”‚   â”‚            Take a Photo            â”‚ â”‚
â”‚   â”‚                                   â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                                   â”‚ â”‚
â”‚   â”‚        ğŸ–¼ï¸  Upload Image            â”‚ â”‚
â”‚   â”‚           From Gallery             â”‚ â”‚
â”‚   â”‚                                   â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â„¹ï¸  Our AI will automatically    â”‚   â”‚
â”‚   â”‚    detect your items and group  â”‚   â”‚
â”‚   â”‚    them by department           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Features
- Large rounded buttons with clear icons
- Descriptive text under each button
- Informational banner about AI capabilities
- Centered, spacious layout

---

## Screen 2: Confirmation (ConfirmDetectedItemsScreen)

### Visual Layout - Successful Detection

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Confirm Items                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PRODUCE                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚ â”‚ Garlic (2)â”‚  â”‚ Tomatoes (3)â”‚          â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                         â”‚
â”‚ DAIRY & REFRIGERATED                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚ â”‚  Milk (1) â”‚  â”‚ Cheese (1)â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                         â”‚
â”‚ PANTRY ESSENTIALS                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚ â”‚ Pasta (1) â”‚  â”‚Olive Oil (1)â”‚          â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                         â”‚
â”‚ [           + Add More Ingredients    ] â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     [  Confirm & Save (7 items)  ]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Interaction Flow

1. **Tapping a Chip**
   ```
   User taps "Garlic (2)" chip
            â†“
   Bottom sheet appears with:
   - Name: "Garlic"
   - Quantity controls: [âˆ’] 2 [+]
   - Unit: "units"
   - Buttons: [Cancel] [Save]
            â†“
   User adjusts quantity
            â†“
   Taps [Save] â†’ Chip updates with new quantity
   ```

2. **Adding Manual Item**
   ```
   User taps FAB (+)
            â†“
   Modal bottom sheet appears with:
   - Text field: "Ingredient Name"
   - Dropdown: "Category" (7 options)
   - Dropdown: "Unit" (units, grams, etc.)
   - Buttons: [Cancel] [Add]
            â†“
   User fills in and taps [Add]
            â†“
   Item added to categorized list
   ```

3. **Confirming All Items**
   ```
   User reviews all items and quantities
            â†“
   Taps "Confirm & Save (7 items)" button
            â†“
   Items saved to PantryProvider
            â†“
   Navigation pops back to Pantry screen
            â†“
   Success SnackBar: "Added 7 items to pantry"
   ```

---

## Category Organization

The 7 categories appear in this order:

1. **Produce** ğŸ¥¬
   - Vegetables, fruits, fresh herbs
   - Default category for uncertain items

2. **Dairy & Refrigerated** ğŸ¥›
   - Milk, cheese, yogurt, butter, eggs
   - Refrigerated items

3. **Meat & Seafood** ğŸ¥©
   - Chicken, beef, fish, seafood
   - Requires refrigeration

4. **Pantry Essentials** ğŸ¥«
   - Oils, vinegars, grains, pasta
   - Shelf-stable staples

5. **Spices & Seasonings** ğŸ§‚
   - Salt, pepper, herbs, spice blends
   - Flavor enhancers

6. **Baking** ğŸ§
   - Flour, sugar, baking powder, chocolate
   - Baking-specific items

7. **Frozen** â„ï¸
   - Frozen vegetables, meats, ice cream
   - Freezer items

---

## Empty State Handling

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Confirm Items                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚              â“˜                          â”‚
â”‚     No items detected in the image      â”‚
â”‚                                         â”‚
â”‚   Try a different image or add items   â”‚
â”‚              manually                  â”‚
â”‚                                         â”‚
â”‚ [           + Add More Ingredients    ] â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [  Confirm & Save (disabled)  ]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- "Confirm & Save" button is **disabled** when empty
- User can only proceed after adding at least one item
- FAB always available for manual entry

---

## Loading State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Processing Image                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚         â†»  (spinning circle)           â”‚
â”‚     Detecting ingredients...            â”‚
â”‚                                         â”‚
â”‚          (appears 2-5 seconds)          â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Cleaning Example

**Raw AI Output:**
```
"Garlic (fresh, minced)"
"Tomatoes (cherry, vine-ripe)"
"Pasta (dried, long noodles)"
```

**After Regex Clean (RegExp r'\(.*?\)' removed):**
```
"Garlic"
"Tomatoes"
"Pasta"
```

---

## Navigation Stack

```
MainNavigation (Tab System)
    â”‚
    â””â”€â†’ Tab 2: AddIngredientScreen (Entry Gate)
           â”‚
           â”œâ”€â†’ [Camera Button] â†’ ImagePicker â†’ Process
           â”‚                          â”‚
           â”‚                          â†“
           â”‚              ConfirmDetectedItemsScreen
           â”‚                    (Full Screen)
           â”‚                          â”‚
           â”‚                          â”œâ”€â†’ [Chip] â†’ Bottom Sheet (Qty)
           â”‚                          â”œâ”€â†’ [FAB] â†’ Modal (Manual)
           â”‚                          â””â”€â†’ [Confirm] â†’ Save & Pop
           â”‚                                 â”‚
           â”‚                                 â†“
           â”‚                        Back to Tab 2
           â”‚                                 â”‚
           â”‚                                 â†“
           â”‚                        Back to Pantry
           â”‚
           â””â”€â†’ [Gallery Button] â†’ ImagePicker â†’ Process â†’ (same flow)
```

---

## Success Flow

1. User presses Tab 2 (Add) â†’ AddIngredientScreen displays
2. User selects Camera or Gallery â†’ Image selected
3. App shows loading spinner â†’ AI processes for 2-5 seconds
4. ConfirmDetectedItemsScreen displays with categorized items
5. User reviews and adjusts quantities as needed
6. User adds any manual items via FAB
7. User taps "Confirm & Save (X items)"
8. Items saved to PantryProvider
9. Navigation pops back 2 screens
10. Success notification: "Added X items to pantry"
11. Items appear in Pantry screen

---

## Error Recovery

### Image Selection Fails
```
Error: "Error selecting image: [error message]"
       â†“
User dismisses SnackBar
       â†“
Back at AddIngredientScreen
       â†“
User tries again with different image source
```

### Detection Fails
```
Spinner shows "Detecting ingredients..."
       â†“
No items detected (empty list)
       â†“
ConfirmDetectedItemsScreen shows empty state
       â†“
User can add items manually via FAB
       â†“
User can go back and try different image
```

---

## Quantity Adjustment Detail

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚  Garlic                                 â”‚
â”‚                                         â”‚
â”‚     [âˆ’] 2 [+]                          â”‚
â”‚         units                           â”‚
â”‚                                         â”‚
â”‚  [Cancel] [Save]                       â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **Minus button** (âˆ’): Decreases quantity, disabled at 0
- **Display**: Current quantity with unit name
- **Plus button** (+): Increases quantity without limit
- **Units** show type (units, grams, cloves, boxes, etc.)

---

## Color Reference

| Element | Color | Hex Code |
|---------|-------|----------|
| Primary Text | Deep Forest Green | #335D50 |
| Accent/Chips | Sage Green | #87A96B |
| Info Banner | Muted Gold | #C3B362 |
| Background | Bone Creame | #EFE5CB |
| Secondary Text | Soft Slate Gray | #4F6D7A |
| Borders | Sage Green (40% opacity) | #87A96B66 |
| Buttons | Deep Forest Green | #335D50 |

